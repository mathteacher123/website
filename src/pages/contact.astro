---
import Layout from '~/layouts/PageLayout.astro';
import HeroText from '~/components/widgets/HeroText.astro';
import ContactUs from '~/components/widgets/Contact.astro';

const metadata = {
  title: 'Contact',
};
---

<Layout metadata={metadata}>
  <!-- HeroText Widget ******************* -->

  <HeroText tagline="Contact" title="Let's Connect!" />
  <ContactUs
    id="form"
    inputs={[
      {
        type: 'email',
        name: 'email',
        label: 'Email',
        required: true,
      },
    ]}
    textarea={{
      label: 'Message',
      name: 'message',
      required: true,
    }}
    description="Our support team typically responds within 24 business hours."
    formMethod="POST",
    formAction='https://formspree.io/f/mvzgnoke',
    formId="contact-form"
  />
  <script is:inline>
      var form = document.getElementById("contact-form");
      
      async function handleSubmit(event) {
        event.preventDefault();
        var status = document.getElementById("contact-form-status");
        var data = new FormData(event.target);
        fetch(event.target.action, {
          method: form.method,
          body: data,
          headers: {
              'Accept': 'application/json'
          }
        }).then(response => {
          if (response.ok) {
            alert("Your message has been received, and we will get back to you soon.");
            form.reset()
          } else {
            response.json().then(data => {
              if (Object.hasOwn(data, 'errors')) {
                alert(data["errors"].map(error => error["message"]).join(", "));
              } else {
                alert("Oops! There was a problem submitting your form");
              }
            })
          }
        }).catch(error => {
          alert("Oops! There was a problem submitting your form");
        });
      }
      form.addEventListener("submit", handleSubmit)
    </script>

  </Layout>
